<div class="p-6">
  <h1 class="text-2xl font-bold mb-4">Admin Dashboard</h1>
  
  <%= link_to "Create User", signup_path, class: "yellow-button w-max" %>
  
  <% if flash[:error].present? %>
    <div class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-4" role="alert">
      <%= flash[:error] %>
    </div>
  <% end %>
  
  <% if @users.nil? %>
    <p>No users available</p>
  <% else %>
    <table class="table-auto text-center w-2/4">
      <thead>
        <tr>
          <th class="px-4 py-2">Email</th>
          <th class="px-4 py-2">First Name</th>
          <th class="px-4 py-2">Last Name</th>
          <th class="px-4 py-2">Status</th>
          <th class="px-4 py-2">Actions</th>
        </tr>
      </thead>
      <tbody>
        <% @users.each do |user| %>
          <% unless user.admin %>
            <tr>
              <td class="border px-4 py-2"><%= user.email %></td>
              <td class="border px-4 py-2"><%= user.first_name %></td>
              <td class="border px-4 py-2"><%= user.last_name %></td>
              <td class="border px-4 py-2 font-bold <%= user.status === 'pending' ? 'bg-red-500' : 'bg-green-500' %>"><%= user.status.capitalize %></td>

              <td class="border px-4 py-2 flex gap-1 justify-evenly">
                <%= button_to user.status == 'pending' ? 'Aprrove' : 'Pending', update_user_status_path(user), method: :patch, class: "bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded" %>
                <%= link_to "Edit", edit_user_path(user), class: "bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded" %>
                <%= button_to "Delete", user_path(user), method: :delete, data: { confirm: "Are you sure you want to delete this user?" }, class: "bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded" %>
              </td>            
            </tr>
          <% end %>
        <% end %>
      </tbody>
    </table>
  <% end %>
</div>

<section class="min-h-[75vh] py-16">
  <div class="wrapper">
      <h1 class="text-4xl font-bold">Admin Dashboard</h1>

        <div class="flex flex-wrap gap-2 p-4">
          <input 
          type="radio"
          class="users-list-selector"
          name="show-users-list"
          id="pending-radio"
          <%= @users.empty? ? nil : 'checked'%>
          >
          <input 
          type="radio"
          class="users-list-selector"
          name="show-users-list"
          id="approved-radio"
          <%= @users.empty? ? 'checked' : nil %>
          >
        <label 
        id="pending-label"
        class="gray-label-button | text-lg font-semibold"
        for="pending-radio">
          Pending
        </label>

        <label 
        for="approved-radio"
        id="approved-label"
        class="gray-label-button | text-lg font-semibold"
        >Approved
        </label>
   </div>
    
  <table class="trans-table w-full">
    <thead class="border-b-1">
      <tr class="table-header text-right">
        <th class="font-normal text-center">Email</th>
        <th class="font-normal text-center">First Name</th>
        <th class="font-normal text-center">Last Name</th>
        <th class="font-normal text-center">Status</th>
        <th class="font-normal text-center">Actions</th>
      </tr>
    </thead>
    <tbody>
      <% if @pending_users.empty? %>
      <tr>
        <td colspan="5" class="text-center font-bold">No Pending Users</td>
      </tr>
      <% else %>
        <% @pending_users.each do |user| %>
        <tr class="text-md" id="pending-users">
          <td class="text-center"><%= user.email %></td>
          <td class="text-center"><%= user.first_name %></td>
          <td class="text-center"><%= user.last_name %></td>
          <td class="text-center"><%= user.status %></td>
          <td class="text-center flex justify-center gap-1">
            <%= button_to user.status == 'pending' ? 'Approve' : 'Pending', update_user_status_path(user), method: :patch, class: "bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded text-xs" %>
            <%= link_to "Edit", edit_user_path(user), class: "bg-gray-500 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded text-xs" %>
            <%= button_to "Delete", user_path(user), method: :delete, data: { confirm: "Are you sure you want to delete this user?" }, class: "bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded text-xs" %>
          </td>
        </tr>
        <% end %>
      <% end %>
    </tbody>
  </table>

</section>

